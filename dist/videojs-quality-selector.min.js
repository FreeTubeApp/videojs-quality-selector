//! @freetube/videojs-quality-selector v1.2.5 ~~ https://github.com/FreeTubeApp/videojs-quality-selector#readme ~~ MIT License
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):(e="undefined"!=typeof globalThis?globalThis:e||self)["videojs-quality-selector"]=t(e.videojs)}(this,function(e){"use strict";class c{constructor(e,t){this._player=e,this._seekToTime=t,this._hasFinished=!1,this._keepThisInstanceWhenPlayerSourcesChange=!1,this._seekWhenSafe()}_seekWhenSafe(){this._player.readyState()<3?(this._seekFn=this._seek.bind(this),this._player.one("canplay",this._seekFn)):this._seek()}onPlayerSourcesChange(){this._keepThisInstanceWhenPlayerSourcesChange?this._keepThisInstanceWhenPlayerSourcesChange=!1:this.cancel()}onQualitySelectionChange(){this.hasFinished()||(this._keepThisInstanceWhenPlayerSourcesChange=!0)}_seek(){this._player.currentTime(this._seekToTime),this._keepThisInstanceWhenPlayerSourcesChange=!1,this._hasFinished=!0}hasFinished(){return this._hasFinished}cancel(){this._player.off("canplay",this._seekFn),this._keepThisInstanceWhenPlayerSourcesChange=!1,this._hasFinished=!0}}const n={QUALITY_REQUESTED:"qualityRequested",QUALITY_SELECTED:"qualitySelected",PLAYER_SOURCES_CHANGED:"playerSourcesChanged"};class i extends e.getComponent("MenuItem"){constructor(e,t){var s=t.source;if("object"!=typeof s||!s)throw new TypeError('was not provided a "source" object, but rather: '+typeof s);super(e,t=Object.assign({selectable:!0,label:s.label},t)),this.source=s}handleClick(e){super.handleClick(e),this.player().trigger(n.QUALITY_REQUESTED,this.source)}}const r="vjs-quality-changing";class o extends e.getComponent("MenuButton"){constructor(s,e){super(s,e),s.on(n.QUALITY_REQUESTED,function(e,t){this.setSelectedSource(t),s.addClass(r),s.one("loadeddata",function(){s.removeClass(r)})}.bind(this)),s.on(n.PLAYER_SOURCES_CHANGED,function(){this.update()}.bind(this)),s.on(n.QUALITY_SELECTED,function(e,t){this.setSelectedSource(t)}.bind(this)),s.one("ready",function(){this.selectedSrc=s.src(),this.update()}.bind(this)),this.controlText("Open quality selector menu")}setSelectedSource(e){var t=e?e.src:void 0;if(this.selectedSrc!==t){this.selectedSrc=t;for(const s of this.items)s.selected(s.source.src===t)}}createItems(){var t=this.player(),e=t.currentSources();return!e||e.length<2?[]:e.map(function(e){return new i(t,{source:e,selected:e.src===this.selectedSrc})}.bind(this))}buildWrapperCSSClass(){return"vjs-quality-selector "+super.buildWrapperCSSClass()}}e.registerComponent("QualitySelector",o);class t extends e.getPlugin("plugin"){constructor(e,t){s.registerComponent("QualitySelector",o),s.registerComponent("QualityOption",i),super(e,s.obj.merge({},t));const s=e||window.videojs;s.hook("setup",function(a){a.on(n.QUALITY_REQUESTED,function(e,t){var s=a.currentSources();let n=a.currentTime(),i=a.playbackRate(),r=a.paused();for(const o of s)o.selected=!1;s.find(e=>e==t.src).selected=!0,a._qualitySelectorSafeSeek&&a._qualitySelectorSafeSeek.onQualitySelectionChange(),a.src(s),a.ready(function(){a._qualitySelectorSafeSeek&&!a._qualitySelectorSafeSeek.hasFinished()||(a._qualitySelectorSafeSeek=new c(a,n),a.playbackRate(i)),r||a.play()})})})}}return{QualitySelectorPlugin:t,CustomEvents:n}});
//# sourceMappingURL=videojs-quality-selector.min.js
